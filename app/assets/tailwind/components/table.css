@layer components {
  .index-data-table-toolbar {
    @apply mb-4 flex flex-col gap-4 lg:flex-row;

    &:not(:has(.index-button-group > *)) {
      @apply mb-0;
    }
  }

  .index-button-group {
    @apply inline-flex flex-wrap items-stretch rounded-md;
  }

  .index-button-group > :where(*:not(:first-child)) {
    @apply my-0 -ms-px;
  }

  .index-button {
    @apply inline-flex items-center justify-center border border-gray-200 bg-white px-3 py-2 text-sm font-medium text-gray-900 no-underline first:rounded-s-md last:rounded-e-md hover:bg-gray-100 focus:z-10 focus:text-blue-700 focus:ring-2 focus:ring-blue-700 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-gray-200 dark:focus:text-white dark:focus:ring-blue-500;
  }

  .index-button-selected {
    @apply bg-gray-100 hover:bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-700;
  }

  .index-as-table {
    @apply relative overflow-x-auto;
  }

  .data-table {
    @apply w-full text-sm text-gray-800 dark:text-gray-200;
  }

  .data-table :where(thead > tr > th) {
    @apply border-b bg-gray-50 px-3 py-3.5 text-start text-xs font-semibold whitespace-nowrap text-gray-700 uppercase dark:border-gray-800 dark:bg-gray-800/30 dark:text-gray-300;
  }

  .data-table :where(thead > tr > th > a) {
    @apply inline-flex items-center gap-2 text-inherit no-underline;
  }

  .data-table-sorted-icon {
    @apply h-1.25 w-2 opacity-25;
  }

  :where(th[data-sort-direction]) {
    @apply text-gray-900! dark:text-white!;

    .data-table-sorted-icon {
      @apply opacity-100;
    }
  }

  :where(th[data-sort-direction="asc"]) .data-table-sorted-icon {
    @apply rotate-180;
  }

  .data-table :where(tbody > tr) {
    @apply border-b dark:border-gray-800;
  }

  .data-table :where(td) {
    @apply px-3 py-4;
  }

  .data-table-resource-actions {
    @apply flex gap-2;
  }

  .attributes-table {
    @apply mb-6 overflow-hidden rounded-md border border-gray-200 shadow-xs dark:border-gray-800;
  }

  .attributes-table > :where(table) {
    @apply w-full text-sm text-gray-800 dark:text-gray-200;
  }

  .attributes-table :where(tbody > tr) {
    @apply space-y-0.5 border-b dark:border-gray-800;
  }

  .attributes-table :where(tbody > tr > th) {
    @apply w-32 bg-gray-50 text-start text-xs text-gray-700 uppercase sm:w-40 dark:bg-gray-800/60 dark:text-gray-300;
  }

  .attributes-table :where(tbody > tr > th, tbody > tr > td) {
    @apply p-3;
  }

  .attributes-table-empty-value {
    @apply text-sm font-semibold text-gray-400/75 uppercase dark:text-gray-500;
  }

  .data-table {
    @apply table-fixed;

    :where(thead > tr > th) {
      @apply border-0 bg-transparent px-2 py-2 text-base font-bold whitespace-normal normal-case;
    }

    :where(td) {
      @apply px-2 py-2 text-base;
    }

    tbody tr {
      @apply border-dotted;
    }

    :where(tbody > tr) {
      @apply border-b border-dotted border-gray-200 dark:border-gray-700;
    }

    tbody tr:first-child {
      @apply border-t border-t-gray-200 dark:border-t-gray-700;
    }

    tbody tr:last-child {
      @apply border-b-0;
    }
  }

  .full-table {
    & table tr th {
      @apply w-full;
    }
  }

  .index-as-table {
    table {
      @apply table-auto border-none shadow-none;
    }

    thead {
      @apply bg-transparent p-4 dark:bg-transparent;
    }

    .data-table :where(thead > tr > th) {
      @apply bg-transparent px-3 text-lg font-medium whitespace-nowrap;
    }

    .data-table :where(tbody > tr > td) {
      @apply px-3;
    }

    .data-table tbody tr:nth-child(odd) {
      @apply border-dotted bg-neutral-50 dark:bg-gray-800/30;
    }

    .data-table tbody tr td input[type="checkbox"] {
      @apply relative size-5;

      &::before {
        @apply absolute content-[""];
        @apply -top-4 -left-4 size-12;
      }
    }
  }

  .data-no-hover {
    & tbody tr {
      @apply hover:bg-transparent;
    }
  }

  .text-right {
    &th a {
      @apply flex flex-row-reverse;
    }
  }

  .data-table-invoice-total {
    @apply table-fixed;

    td {
      @apply align-baseline leading-10;
    }

    td details > summary {
      @apply leading-10;
    }

    td details {
      @apply mb-1.5 -ml-24;
    }

    tr:last-child,
    tr:nth-last-child(2),
    tr:nth-last-child(4) {
      @apply border-none!;
    }

    tr:nth-last-child(2) td:last-child,
    tr:nth-last-child(4) td:last-child {
      @apply border-b border-black dark:border-white;
    }

    tr:last-child td {
      @apply font-bold;
    }
  }

  .data-table-total {
    tr:last-child,
    tr:nth-last-child(2) {
      @apply border-none!;
    }

    tr:nth-last-child(2) td:last-child {
      @apply border-b border-black dark:border-white;
    }

    tr:last-child td {
      @apply font-bold;
    }
  }

  .data-table-resource-actions {
    @apply flex items-center justify-end gap-2;

    a {
      @apply text-gray-400 hover:text-green-600 dark:text-gray-500 dark:hover:text-green-400;
    }
  }

  .attributes-table {
    @apply mb-0 border-none px-2 shadow-none;

    & > :where(table) {
      @apply block;
    }

    & :where(tbody) {
      @apply block;
    }

    & :where(tbody > tr) {
      @apply flex border-dotted border-gray-200 dark:border-gray-700;
    }

    & :where(tbody > tr:last-child) {
      @apply border-none;
    }

    & :where(tbody > tr > th) {
      @apply flex items-start;
    }

    & :where(tbody > tr > th, tbody > tr > td) {
      @apply p-0 py-1.5 text-base;
    }

    & :where(tbody > tr > th) {
      @apply w-auto max-w-[50%] min-w-24 shrink-0 bg-transparent text-start text-base leading-5 font-semibold text-gray-700 normal-case dark:bg-transparent dark:text-gray-300;
    }

    & :where(tbody > tr > td) {
      @apply min-w-0 flex-1 pl-4 text-right leading-5;

      & :where(.flex) {
        @apply justify-end;
      }
    }

    & td .status-tag {
      @apply mb-0;
    }
  }

  :is(.attributes-table, .data-table-invoice-total) td details {
    interpolate-size: allow-keywords;
  }

  :is(.attributes-table, .data-table-invoice-total) td details > summary {
    @apply flex cursor-pointer list-none items-center justify-end leading-[1.4rem];

    &::marker,
    &::-webkit-details-marker {
      display: none;
    }

    &::before {
      content: "";
      @apply mr-1.5 size-3 shrink-0 text-gray-400 transition-transform duration-200 dark:text-gray-500;
      background-color: currentColor;
      clip-path: polygon(25% 10%, 85% 50%, 25% 90%);
    }
  }

  :is(.attributes-table, .data-table-invoice-total)
    td
    details[open]
    > summary::before {
    @apply rotate-90;
  }

  :is(.attributes-table, .data-table-invoice-total)
    td
    details::details-content {
    block-size: 0;
    overflow: hidden;
    opacity: 0;
    transition:
      block-size 200ms ease,
      opacity 200ms ease,
      content-visibility 200ms allow-discrete;
  }

  :is(.attributes-table, .data-table-invoice-total)
    td
    details[open]::details-content {
    block-size: auto;
    opacity: 1;
  }

  :is(.attributes-table, .data-table-invoice-total) td details > .details-grid {
    @apply mt-1 grid min-w-0 grid-cols-[1fr_auto] items-baseline gap-x-4 leading-6;

    .details-month {
      @apply text-right text-xs whitespace-nowrap text-gray-500 dark:text-gray-400;
    }

    .details-amount {
      @apply text-right whitespace-nowrap text-gray-500 tabular-nums dark:text-gray-400;
    }
  }

  .partially-hidden {
    &table {
      tr:nth-child(n + 10) {
        @apply border-0;
      }

      tr:nth-child(n + 11) {
        @apply hidden;
      }
    }
  }

  tr[data-table-row-target="row"] {
    @apply focus:bg-neutral-100! focus:outline-none focus:dark:bg-neutral-700!;
  }

  tbody[data-controller="sortable"] tr {
    @apply hover:bg-neutral-100 hover:dark:bg-neutral-700;
  }
}
