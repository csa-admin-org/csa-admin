<% membership = current_member.current_or_future_membership %>

<% show_notice = membership&.absences_included&.positive? &&
    membership.absences_included_remaining.positive? &&
    # In provisional_absence mode after reminder, hide if all baskets have been forced
    !(membership.absences_included_reminded? &&
      Current.org.absences_included_mode == "provisional_absence" &&
      membership.baskets.provisionally_absent.none?) %>

<% if show_notice %>
  <%= link_to members_absences_path do %>
    <%= notice_pane("calendar-date-range") do %>
      <% prefix = membership.absences_included_reminded? ? "reminded_" : "" %>
      <% mode = Current.org.absences_included_mode %>
      <% announced = membership.absences_included - membership.absences_included_remaining %>

      <%= t(".#{prefix}#{mode}_html",
            announced: announced,
            count: membership.absences_included,
            remaining: membership.absences_included_remaining) %>
    <% end %>
  <% end %>
<% end %>
